<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="Michael Mayer" />

<meta name="date" content="2021-01-06" />

<title>Using ‘outForest’</title>

<script>// Hide empty <a> tag within highlighted CodeBlock for screen reader accessibility (see https://github.com/jgm/pandoc/issues/6352#issuecomment-626106786) -->
// v0.0.1
// Written by JooYoung Seo (jooyoung@psu.edu) and Atsushi Yasumoto on June 1st, 2020.

document.addEventListener('DOMContentLoaded', function() {
  const codeList = document.getElementsByClassName("sourceCode");
  for (var i = 0; i < codeList.length; i++) {
    var linkList = codeList[i].getElementsByTagName('a');
    for (var j = 0; j < linkList.length; j++) {
      if (linkList[j].innerHTML === "") {
        linkList[j].setAttribute('aria-hidden', 'true');
      }
    }
  }
});
</script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Using ‘outForest’</h1>
<h4 class="author">Michael Mayer</h4>
<h4 class="date">2021-01-06</h4>



<div id="introduction" class="section level2">
<h2>Introduction</h2>
<p>The aim of this vignette is to introduce the R package <code>outForest</code> for multivariate outlier detection and replacement.</p>
<p><code>outForest</code> is a random forest based implementation of the method described in Chapter 7.1.2 (“Regression model based anomaly detection”) of <span class="citation">(Chandola, Banerjee, and Kumar <a href="#ref-Chandola2009" role="doc-biblioref">2009</a>)</span>. Each numeric variable is regressed onto all other variables using a random forest. If the scaled absolute difference between observed value and out-of-bag prediction is suspiciouly large (e.g. more than three times the RMSE of the out-of-bag predictions), then a value is considered an outlier. After identification of outliers, they can be replaced e.g. by predictive mean matching from the non-outliers.</p>
<p>The method can be viewed as a multivariate extension of a basic univariate outlier detection method where a value is considered an outlier if it is more than e.g. three times the standard deviation away from its mean. In the multivariate case, instead of comparing a value with the overall mean, rather the difference to the conditional mean is considered. The <code>outForest</code> package estimates this conditional mean by a random forest.</p>
<p>Specificly, the outlier score of the <span class="math inline">\(i\)</span>-th observed value <span class="math inline">\(x_{ij}\)</span> of variable <span class="math inline">\(j\)</span> is defined as <span class="math display">\[
  s_{ij} = \frac{x_{ij} - \text{pred}_{ij}}{\text{rmse}_j},
\]</span> where <span class="math inline">\(\text{pred}_{ij}\)</span> is is the corresponding out-of-bag prediction of the j-th random forest with RMSE <span class="math inline">\(\text{rmse}_j\)</span>. If <span class="math inline">\(|s_{ij}| &gt; L\)</span> with threshold <span class="math inline">\(L\)</span>, then <span class="math inline">\(x_{ij}\)</span> is considered an outlier.</p>
<p>Why using random forests for calculating the conditional means? They often work well without parameter tuning, outliers in the input variables are no issue and the out-of-bag mechanism helps to provide fair outlier scores.</p>
<p><code>outForest</code> utilizes the high-performance random forest implementation <code>ranger</code> <span class="citation">(Wright and Ziegler <a href="#ref-wright2017" role="doc-biblioref">2017</a>)</span>. Since it does not allow for missing values, any missing value is first being imputed by chained random forests, see <span class="citation">(Buuren and Groothuis-Oudshoorn <a href="#ref-buuren2011" role="doc-biblioref">2011</a>)</span>.</p>
<p>In the examples below, we will meet different functions from the <code>outForest</code> package:</p>
<ul>
<li><p><code>outForest</code>: This is the main function. It identifies and replaces outliers in numeric variables of a data frame.</p></li>
<li><p><code>print</code>, <code>summary</code> and <code>plot</code>: To inspect outlier information.</p></li>
<li><p><code>outliers</code> and <code>Data</code>: To extract information on outliers and the data with replaced outliers.</p></li>
<li><p><code>generateOutliers</code>: To add nasty outliers to a data set.</p></li>
<li><p><code>predict</code>: To apply a fitted <code>outRanger</code> object to fresh data.</p></li>
</ul>
</div>
<div id="installation" class="section level2">
<h2>Installation</h2>
<p>From CRAN:</p>
<pre><code>install.packages(&quot;outForest&quot;)</code></pre>
<p>Latest version from github:</p>
<pre><code>library(devtools)
install_github(&quot;mayer79/outForest&quot;)</code></pre>
</div>
<div id="examples" class="section level2">
<h2>Examples</h2>
<p>We first generate a data set with two truely multivariate outliers. Then, we use <code>outForest</code> to hunt them down.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a><span class="kw">library</span>(outForest)</span>
<span id="cb3-2"><a href="#cb3-2"></a></span>
<span id="cb3-3"><a href="#cb3-3"></a><span class="co"># Create data set with truely multivariate outlier</span></span>
<span id="cb3-4"><a href="#cb3-4"></a><span class="kw">set.seed</span>(<span class="dv">3</span>)</span>
<span id="cb3-5"><a href="#cb3-5"></a>t &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dv">0</span>, pi, <span class="dt">by =</span> <span class="fl">0.01</span>)</span>
<span id="cb3-6"><a href="#cb3-6"></a>dat &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">x =</span> <span class="kw">cos</span>(t), <span class="dt">y =</span> <span class="kw">sin</span>(t) <span class="op">+</span><span class="st"> </span><span class="kw">runif</span>(<span class="kw">length</span>(t), <span class="fl">-0.1</span>, <span class="fl">0.1</span>))</span>
<span id="cb3-7"><a href="#cb3-7"></a>dat[<span class="kw">c</span>(<span class="dv">100</span>, <span class="dv">200</span>), ] &lt;-<span class="st"> </span><span class="kw">cbind</span>(<span class="kw">c</span>(<span class="op">-</span><span class="fl">0.5</span>, <span class="fl">0.5</span>), <span class="kw">c</span>(<span class="fl">0.4</span>, <span class="fl">0.4</span>))</span>
<span id="cb3-8"><a href="#cb3-8"></a></span>
<span id="cb3-9"><a href="#cb3-9"></a><span class="kw">plot</span>(y <span class="op">~</span><span class="st"> </span>x, <span class="dt">data =</span> dat)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1"></a></span>
<span id="cb4-2"><a href="#cb4-2"></a><span class="co"># Let&#39;s run outForest on that data</span></span>
<span id="cb4-3"><a href="#cb4-3"></a>ch &lt;-<span class="st"> </span><span class="kw">outForest</span>(dat)</span>
<span id="cb4-4"><a href="#cb4-4"></a><span class="co">#&gt; </span></span>
<span id="cb4-5"><a href="#cb4-5"></a><span class="co">#&gt; Outlier identification by random forests</span></span>
<span id="cb4-6"><a href="#cb4-6"></a><span class="co">#&gt; </span></span>
<span id="cb4-7"><a href="#cb4-7"></a><span class="co">#&gt;   Variables to check:        x, y</span></span>
<span id="cb4-8"><a href="#cb4-8"></a><span class="co">#&gt;   Variables used to check:   x, y</span></span>
<span id="cb4-9"><a href="#cb4-9"></a><span class="co">#&gt; </span></span>
<span id="cb4-10"><a href="#cb4-10"></a><span class="co">#&gt;   Checking: x  y</span></span>
<span id="cb4-11"><a href="#cb4-11"></a></span>
<span id="cb4-12"><a href="#cb4-12"></a><span class="co"># What outliers did we find?</span></span>
<span id="cb4-13"><a href="#cb4-13"></a><span class="kw">outliers</span>(ch)</span>
<span id="cb4-14"><a href="#cb4-14"></a><span class="co">#&gt;   row col observed predicted       rmse     score threshold replacement</span></span>
<span id="cb4-15"><a href="#cb4-15"></a><span class="co">#&gt; 1 100   y      0.4 0.8567112 0.07485516 -6.101265         3   0.9913182</span></span>
<span id="cb4-16"><a href="#cb4-16"></a><span class="co">#&gt; 2 200   y      0.4 0.8244413 0.07485516 -5.670168         3   0.8113720</span></span>
<span id="cb4-17"><a href="#cb4-17"></a></span>
<span id="cb4-18"><a href="#cb4-18"></a><span class="co"># Bingo! How does the fixed data set looks like?</span></span>
<span id="cb4-19"><a href="#cb4-19"></a><span class="kw">plot</span>(y <span class="op">~</span><span class="st"> </span>x, <span class="dt">data =</span> <span class="kw">Data</span>(ch))</span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAVFBMVEUAAAAAADoAAGYAOjoAOpAAZrY6AAA6ADo6AGY6Ojo6kNtmAABmADpmZmZmtv+QOgCQ2/+2ZgC2/7a2///bkDrb/9vb////tmb/25D//7b//9v////oPA8/AAAACXBIWXMAAA7DAAAOwwHHb6hkAAAJx0lEQVR4nO2dAX/bJhDFWdd2W7PN8+bNSfj+33O2JOBONn4IIXFO3vutWSyh4/QXHAeirvPUQ7neDlgXAQEREBABAREQEAEBERAQAQEREBABAREQEAEBERAQAQEREBABAREQEAEBERAQAQEREBABAREQEAEBERAQAQEREBABAREQEAEBERAQAQEREBABAREQEAEBERAQAQEREBABAREQEAEBERAQAQEREBABAREQEAEBERAQAQEREBABAREQEAEBERAQAQEREBABAREQEAEBERAQAQEREBABAREQEAEBERAQAQEREBABAREQEAEBERAQAQEREBABAREQUGNA7mnUC1BbcwPx1iZHu80LdjE32NuE0IcAFLqC26AhPTmggYcb/jf+4mN4a1PBkwMSPNzAKeFpReiZAU39yon/fOQUaK3tdE8JKEScwCP8jL/60KbWR+/nA5To+NiZRAwS/S2WW+P8UwFysRf52KF0TheQjSe8jNtbO9oT0HR7oR/52HoSmulEZBOJiX5WRekZAIUUZ+SSAKX2EgNQCkNO9LyJ7xSVNnK00bi8eIoTak5dKIxUanyfzo5/vDjuE8TQnpZ53Lxgc3Ph8UsIISYLXCkgJY4yMoWcYCtH+wISsSYGJHkw5oiqkaYGlI5u5mjXGCTbhYwos0YTh3wVnRSu7RztNgcUEUTeth7H/KzliBmH+vnxYlAcoGeDlmw5XnXDu2mAEye3cbQToBigdXuJcFLGLAupCB5PiBxz8RjasmBTc7e534xTzIxko5qni4FazBoXINoI0NG5b++Hix9/rjM33e4s/sz6WCyVel0s7n1sP060tXBxkQfFrpbr9PW/C6Nv3r+9/FhnTofb2eQrAhCJUMqb/YzVFIBkylTkQLGn5Xo/XLCcf/rLj6jqzM27iE4G02GdN8a7dvqI8wKYSJna3fcSQG8vl551/vKPDz8rzMnplripWRNKN3lzv+mkCEt+ZqvIjzLt3IJuEmMv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" /><!-- --></p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a></span>
<span id="cb5-2"><a href="#cb5-2"></a><span class="co"># The number of outliers per variable</span></span>
<span id="cb5-3"><a href="#cb5-3"></a><span class="kw">plot</span>(ch)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>Note that <code>outForest</code> offers a <code>...</code> argument to pass options to its workhorse random forest implementation <code>ranger</code>, e.g. <code>num.trees</code> or <code>mtry</code>. How would we use its “extra trees” variant with 50 trees? As data set, we add a couple of outliers to the famous iris flower data set.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1"></a><span class="kw">head</span>(irisWithOutliers &lt;-<span class="st"> </span><span class="kw">generateOutliers</span>(iris, <span class="dt">p =</span> <span class="fl">0.02</span>))</span>
<span id="cb6-2"><a href="#cb6-2"></a><span class="co">#&gt;   Sepal.Length Sepal.Width Petal.Length Petal.Width Species</span></span>
<span id="cb6-3"><a href="#cb6-3"></a><span class="co">#&gt; 1          5.1         3.5      1.40000         0.2  setosa</span></span>
<span id="cb6-4"><a href="#cb6-4"></a><span class="co">#&gt; 2          4.9         3.0    -13.32449         0.2  setosa</span></span>
<span id="cb6-5"><a href="#cb6-5"></a><span class="co">#&gt; 3          4.7         3.2      1.30000         0.2  setosa</span></span>
<span id="cb6-6"><a href="#cb6-6"></a><span class="co">#&gt; 4          4.6         3.1      1.50000         0.2  setosa</span></span>
<span id="cb6-7"><a href="#cb6-7"></a><span class="co">#&gt; 5          5.0         3.6      1.40000         0.2  setosa</span></span>
<span id="cb6-8"><a href="#cb6-8"></a><span class="co">#&gt; 6          5.4         3.9      1.70000         0.4  setosa</span></span>
<span id="cb6-9"><a href="#cb6-9"></a>out &lt;-<span class="st"> </span><span class="kw">outForest</span>(irisWithOutliers, <span class="dt">splitrule =</span> <span class="st">&quot;extratrees&quot;</span>, </span>
<span id="cb6-10"><a href="#cb6-10"></a>                 <span class="dt">num.trees =</span> <span class="dv">50</span>, <span class="dt">verbose =</span> <span class="dv">0</span>)</span>
<span id="cb6-11"><a href="#cb6-11"></a></span>
<span id="cb6-12"><a href="#cb6-12"></a><span class="co"># The worst outliers</span></span>
<span id="cb6-13"><a href="#cb6-13"></a><span class="kw">head</span>(<span class="kw">outliers</span>(out))</span>
<span id="cb6-14"><a href="#cb6-14"></a><span class="co">#&gt;   row          col   observed predicted      rmse     score threshold</span></span>
<span id="cb6-15"><a href="#cb6-15"></a><span class="co">#&gt; 9  77  Petal.Width   8.617485  1.462865 0.6365155 11.240290         3</span></span>
<span id="cb6-16"><a href="#cb6-16"></a><span class="co">#&gt; 7   2 Petal.Length -13.324488  1.572715 1.5200990 -9.800153         3</span></span>
<span id="cb6-17"><a href="#cb6-17"></a><span class="co">#&gt; 6 135  Sepal.Width  -5.061389  3.120949 0.9375457 -8.727402         3</span></span>
<span id="cb6-18"><a href="#cb6-18"></a><span class="co">#&gt; 1  66 Sepal.Length  16.880345  6.070454 1.4580339  7.414019         3</span></span>
<span id="cb6-19"><a href="#cb6-19"></a><span class="co">#&gt; 2 127 Sepal.Length  -4.004644  6.355322 1.4580339 -7.105436         3</span></span>
<span id="cb6-20"><a href="#cb6-20"></a><span class="co">#&gt; 8 136 Petal.Length  -4.054545  5.790103 1.5200990 -6.476321         3</span></span>
<span id="cb6-21"><a href="#cb6-21"></a><span class="co">#&gt;   replacement</span></span>
<span id="cb6-22"><a href="#cb6-22"></a><span class="co">#&gt; 9         1.5</span></span>
<span id="cb6-23"><a href="#cb6-23"></a><span class="co">#&gt; 7         1.3</span></span>
<span id="cb6-24"><a href="#cb6-24"></a><span class="co">#&gt; 6         3.0</span></span>
<span id="cb6-25"><a href="#cb6-25"></a><span class="co">#&gt; 1         6.1</span></span>
<span id="cb6-26"><a href="#cb6-26"></a><span class="co">#&gt; 2         7.3</span></span>
<span id="cb6-27"><a href="#cb6-27"></a><span class="co">#&gt; 8         6.7</span></span>
<span id="cb6-28"><a href="#cb6-28"></a></span>
<span id="cb6-29"><a href="#cb6-29"></a><span class="co"># Summary of outliers</span></span>
<span id="cb6-30"><a href="#cb6-30"></a><span class="kw">summary</span>(out)</span>
<span id="cb6-31"><a href="#cb6-31"></a><span class="co">#&gt; The following outlier counts have been detected:</span></span>
<span id="cb6-32"><a href="#cb6-32"></a><span class="co">#&gt; </span></span>
<span id="cb6-33"><a href="#cb6-33"></a><span class="co">#&gt;              Number of outliers</span></span>
<span id="cb6-34"><a href="#cb6-34"></a><span class="co">#&gt; Sepal.Length                  3</span></span>
<span id="cb6-35"><a href="#cb6-35"></a><span class="co">#&gt; Sepal.Width                   3</span></span>
<span id="cb6-36"><a href="#cb6-36"></a><span class="co">#&gt; Petal.Length                  2</span></span>
<span id="cb6-37"><a href="#cb6-37"></a><span class="co">#&gt; Petal.Width                   1</span></span>
<span id="cb6-38"><a href="#cb6-38"></a><span class="co">#&gt; </span></span>
<span id="cb6-39"><a href="#cb6-39"></a><span class="co">#&gt; These are the worst outliers:</span></span>
<span id="cb6-40"><a href="#cb6-40"></a><span class="co">#&gt; </span></span>
<span id="cb6-41"><a href="#cb6-41"></a><span class="co">#&gt;   row          col   observed predicted      rmse     score threshold</span></span>
<span id="cb6-42"><a href="#cb6-42"></a><span class="co">#&gt; 9  77  Petal.Width   8.617485  1.462865 0.6365155 11.240290         3</span></span>
<span id="cb6-43"><a href="#cb6-43"></a><span class="co">#&gt; 7   2 Petal.Length -13.324488  1.572715 1.5200990 -9.800153         3</span></span>
<span id="cb6-44"><a href="#cb6-44"></a><span class="co">#&gt; 6 135  Sepal.Width  -5.061389  3.120949 0.9375457 -8.727402         3</span></span>
<span id="cb6-45"><a href="#cb6-45"></a><span class="co">#&gt; 1  66 Sepal.Length  16.880345  6.070454 1.4580339  7.414019         3</span></span>
<span id="cb6-46"><a href="#cb6-46"></a><span class="co">#&gt; 2 127 Sepal.Length  -4.004644  6.355322 1.4580339 -7.105436         3</span></span>
<span id="cb6-47"><a href="#cb6-47"></a><span class="co">#&gt; 8 136 Petal.Length  -4.054545  5.790103 1.5200990 -6.476321         3</span></span>
<span id="cb6-48"><a href="#cb6-48"></a><span class="co">#&gt;   replacement</span></span>
<span id="cb6-49"><a href="#cb6-49"></a><span class="co">#&gt; 9         1.5</span></span>
<span id="cb6-50"><a href="#cb6-50"></a><span class="co">#&gt; 7         1.3</span></span>
<span id="cb6-51"><a href="#cb6-51"></a><span class="co">#&gt; 6         3.0</span></span>
<span id="cb6-52"><a href="#cb6-52"></a><span class="co">#&gt; 1         6.1</span></span>
<span id="cb6-53"><a href="#cb6-53"></a><span class="co">#&gt; 2         7.3</span></span>
<span id="cb6-54"><a href="#cb6-54"></a><span class="co">#&gt; 8         6.7</span></span>
<span id="cb6-55"><a href="#cb6-55"></a></span>
<span id="cb6-56"><a href="#cb6-56"></a><span class="co"># Basic plot of the number of outliers per variable</span></span>
<span id="cb6-57"><a href="#cb6-57"></a><span class="kw">plot</span>(out)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1"></a></span>
<span id="cb7-2"><a href="#cb7-2"></a><span class="co"># Basic plot of the scores of the outliers per variable</span></span>
<span id="cb7-3"><a href="#cb7-3"></a><span class="kw">plot</span>(out, <span class="dt">what =</span> <span class="st">&quot;scores&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1"></a></span>
<span id="cb8-2"><a href="#cb8-2"></a><span class="co"># The fixed data</span></span>
<span id="cb8-3"><a href="#cb8-3"></a><span class="kw">head</span>(<span class="kw">Data</span>(out))</span>
<span id="cb8-4"><a href="#cb8-4"></a><span class="co">#&gt;   Sepal.Length Sepal.Width Petal.Length Petal.Width Species</span></span>
<span id="cb8-5"><a href="#cb8-5"></a><span class="co">#&gt; 1          5.1         3.5          1.4         0.2  setosa</span></span>
<span id="cb8-6"><a href="#cb8-6"></a><span class="co">#&gt; 2          4.9         3.0          1.3         0.2  setosa</span></span>
<span id="cb8-7"><a href="#cb8-7"></a><span class="co">#&gt; 3          4.7         3.2          1.3         0.2  setosa</span></span>
<span id="cb8-8"><a href="#cb8-8"></a><span class="co">#&gt; 4          4.6         3.1          1.5         0.2  setosa</span></span>
<span id="cb8-9"><a href="#cb8-9"></a><span class="co">#&gt; 5          5.0         3.6          1.4         0.2  setosa</span></span>
<span id="cb8-10"><a href="#cb8-10"></a><span class="co">#&gt; 6          5.4         3.9          1.7         0.4  setosa</span></span></code></pre></div>
<p>Further note that <code>outForest</code> does not rely on <code>tidyverse</code> but you can embed it into a <code>dplyr</code> pipeline (without <code>group_by</code>). Make sure to set <code>verbose = 0</code> in order to prevent messages flooding your screen.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1"></a><span class="kw">library</span>(dplyr)</span>
<span id="cb9-2"><a href="#cb9-2"></a></span>
<span id="cb9-3"><a href="#cb9-3"></a>irisWithOutliers <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb9-4"><a href="#cb9-4"></a><span class="st">  </span><span class="kw">outForest</span>(<span class="dt">verbose =</span> <span class="dv">0</span>) <span class="op">%&gt;%</span></span>
<span id="cb9-5"><a href="#cb9-5"></a><span class="st">  </span><span class="kw">Data</span>() <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb9-6"><a href="#cb9-6"></a><span class="st">  </span><span class="kw">head</span>()</span>
<span id="cb9-7"><a href="#cb9-7"></a><span class="co">#&gt;   Sepal.Length Sepal.Width Petal.Length Petal.Width Species</span></span>
<span id="cb9-8"><a href="#cb9-8"></a><span class="co">#&gt; 1          5.1         3.5          1.4         0.2  setosa</span></span>
<span id="cb9-9"><a href="#cb9-9"></a><span class="co">#&gt; 2          4.9         3.0          1.5         0.2  setosa</span></span>
<span id="cb9-10"><a href="#cb9-10"></a><span class="co">#&gt; 3          4.7         3.2          1.3         0.2  setosa</span></span>
<span id="cb9-11"><a href="#cb9-11"></a><span class="co">#&gt; 4          4.6         3.1          1.5         0.2  setosa</span></span>
<span id="cb9-12"><a href="#cb9-12"></a><span class="co">#&gt; 5          5.0         3.6          1.4         0.2  setosa</span></span>
<span id="cb9-13"><a href="#cb9-13"></a><span class="co">#&gt; 6          5.4         3.9          1.7         0.4  setosa</span></span></code></pre></div>
</div>
<div id="out-of-sample-application" class="section level2">
<h2>Out-of-sample application</h2>
<p>Once an <code>outForest</code> object is fitted with option <code>allow_predictions = TRUE</code>, it can be used to find and replace outliers in new data without refitting. Note that random forests can be huge, so use this option with care. Further note that currently, missing values in the new data are only allowed in one single variable to be checked.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1"></a>out &lt;-<span class="st"> </span><span class="kw">outForest</span>(iris, <span class="dt">allow_predictions =</span> <span class="ot">TRUE</span>, <span class="dt">verbose =</span> <span class="dv">0</span>)</span>
<span id="cb10-2"><a href="#cb10-2"></a>iris1 &lt;-<span class="st"> </span>iris[<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>, ]</span>
<span id="cb10-3"><a href="#cb10-3"></a>iris1<span class="op">$</span>Sepal.Length[<span class="dv">1</span>] &lt;-<span class="st"> </span><span class="dv">-1</span></span>
<span id="cb10-4"><a href="#cb10-4"></a>pred &lt;-<span class="st"> </span><span class="kw">predict</span>(out, <span class="dt">newdata =</span> iris1)</span>
<span id="cb10-5"><a href="#cb10-5"></a><span class="kw">outliers</span>(pred)</span>
<span id="cb10-6"><a href="#cb10-6"></a><span class="co">#&gt;   row          col observed predicted      rmse     score threshold replacement</span></span>
<span id="cb10-7"><a href="#cb10-7"></a><span class="co">#&gt; 1   1 Sepal.Length       -1  5.009533 0.3684992 -16.30813         3         5.8</span></span>
<span id="cb10-8"><a href="#cb10-8"></a><span class="kw">Data</span>(pred)</span>
<span id="cb10-9"><a href="#cb10-9"></a><span class="co">#&gt;   Sepal.Length Sepal.Width Petal.Length Petal.Width Species</span></span>
<span id="cb10-10"><a href="#cb10-10"></a><span class="co">#&gt; 1          5.8         3.5          1.4         0.2  setosa</span></span>
<span id="cb10-11"><a href="#cb10-11"></a><span class="co">#&gt; 2          4.9         3.0          1.4         0.2  setosa</span></span></code></pre></div>
</div>
<div id="the-formula-interface" class="section level2">
<h2>The formula interface</h2>
<p>By default <code>outForest</code> uses all columns in the data set to check all numeric columns with missings. To override this behaviour, you can use its formula interface: The left hand side specifies the variables to be checked (variable names separated by a <code>+</code>), while the right hand side lists the variables used for checking.</p>
<p>So if you e.g. want to check only variable <code>Sepal.Length</code> based on <code>Species</code>, then use this syntax.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1"></a>out &lt;-<span class="st"> </span><span class="kw">outForest</span>(irisWithOutliers, Sepal.Length <span class="op">~</span><span class="st"> </span>Species, <span class="dt">verbose =</span> <span class="dv">0</span>)</span>
<span id="cb11-2"><a href="#cb11-2"></a><span class="kw">summary</span>(out)</span>
<span id="cb11-3"><a href="#cb11-3"></a><span class="co">#&gt; The following outlier counts have been detected:</span></span>
<span id="cb11-4"><a href="#cb11-4"></a><span class="co">#&gt; </span></span>
<span id="cb11-5"><a href="#cb11-5"></a><span class="co">#&gt;              Number of outliers</span></span>
<span id="cb11-6"><a href="#cb11-6"></a><span class="co">#&gt; Sepal.Length                  3</span></span>
<span id="cb11-7"><a href="#cb11-7"></a><span class="co">#&gt; </span></span>
<span id="cb11-8"><a href="#cb11-8"></a><span class="co">#&gt; These are the worst outliers:</span></span>
<span id="cb11-9"><a href="#cb11-9"></a><span class="co">#&gt; </span></span>
<span id="cb11-10"><a href="#cb11-10"></a><span class="co">#&gt;   row          col  observed predicted    rmse     score threshold replacement</span></span>
<span id="cb11-11"><a href="#cb11-11"></a><span class="co">#&gt; 1  66 Sepal.Length 16.880345  5.923771 1.49106  7.348177         3         6.2</span></span>
<span id="cb11-12"><a href="#cb11-12"></a><span class="co">#&gt; 2 127 Sepal.Length -4.004644  6.745993 1.49106 -7.210062         3         5.9</span></span>
<span id="cb11-13"><a href="#cb11-13"></a><span class="co">#&gt; 3 135 Sepal.Length 13.663652  6.358692 1.49106  4.899171         3         7.7</span></span></code></pre></div>
<p>If you want to prevent <code>outForest</code> to identify and replace outliers in the response variable of a subsequent model, <code>Sepal.Length</code> say, subtract that variable from the left hand side.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1"></a>out &lt;-<span class="st"> </span><span class="kw">outForest</span>(irisWithOutliers, . <span class="op">-</span><span class="st"> </span>Sepal.Length <span class="op">~</span><span class="st"> </span>., <span class="dt">verbose =</span> <span class="dv">0</span>)</span>
<span id="cb12-2"><a href="#cb12-2"></a><span class="kw">summary</span>(out)</span>
<span id="cb12-3"><a href="#cb12-3"></a><span class="co">#&gt; The following outlier counts have been detected:</span></span>
<span id="cb12-4"><a href="#cb12-4"></a><span class="co">#&gt; </span></span>
<span id="cb12-5"><a href="#cb12-5"></a><span class="co">#&gt;              Number of outliers</span></span>
<span id="cb12-6"><a href="#cb12-6"></a><span class="co">#&gt; Sepal.Width                   4</span></span>
<span id="cb12-7"><a href="#cb12-7"></a><span class="co">#&gt; Petal.Length                  2</span></span>
<span id="cb12-8"><a href="#cb12-8"></a><span class="co">#&gt; Petal.Width                   1</span></span>
<span id="cb12-9"><a href="#cb12-9"></a><span class="co">#&gt; </span></span>
<span id="cb12-10"><a href="#cb12-10"></a><span class="co">#&gt; These are the worst outliers:</span></span>
<span id="cb12-11"><a href="#cb12-11"></a><span class="co">#&gt; </span></span>
<span id="cb12-12"><a href="#cb12-12"></a><span class="co">#&gt;   row          col   observed predicted      rmse     score threshold</span></span>
<span id="cb12-13"><a href="#cb12-13"></a><span class="co">#&gt; 7  77  Petal.Width   8.617485  1.565126 0.6429529 10.968703         3</span></span>
<span id="cb12-14"><a href="#cb12-14"></a><span class="co">#&gt; 5   2 Petal.Length -13.324488  1.446070 1.5599565 -9.468570         3</span></span>
<span id="cb12-15"><a href="#cb12-15"></a><span class="co">#&gt; 4 135  Sepal.Width  -5.061389  3.245469 0.9814244 -8.464083         3</span></span>
<span id="cb12-16"><a href="#cb12-16"></a><span class="co">#&gt; 6 136 Petal.Length  -4.054545  6.009261 1.5599565 -6.451338         3</span></span>
<span id="cb12-17"><a href="#cb12-17"></a><span class="co">#&gt; 3 117  Sepal.Width   8.720982  2.986622 0.9814244  5.842895         3</span></span>
<span id="cb12-18"><a href="#cb12-18"></a><span class="co">#&gt; 2  66  Sepal.Width   3.100000 -1.177281 0.9814244  4.358238         3</span></span>
<span id="cb12-19"><a href="#cb12-19"></a><span class="co">#&gt;   replacement</span></span>
<span id="cb12-20"><a href="#cb12-20"></a><span class="co">#&gt; 7         1.5</span></span>
<span id="cb12-21"><a href="#cb12-21"></a><span class="co">#&gt; 5         1.9</span></span>
<span id="cb12-22"><a href="#cb12-22"></a><span class="co">#&gt; 4         3.2</span></span>
<span id="cb12-23"><a href="#cb12-23"></a><span class="co">#&gt; 6         6.0</span></span>
<span id="cb12-24"><a href="#cb12-24"></a><span class="co">#&gt; 3         3.2</span></span>
<span id="cb12-25"><a href="#cb12-25"></a><span class="co">#&gt; 2         2.4</span></span></code></pre></div>
</div>
<div id="too-many-values-are-identified-as-outliers.-crap" class="section level2">
<h2>Too many values are identified as outliers. Crap!</h2>
<p>For large data sets, just by chance, many values can surpass the default threshold of 3. To reduce the number of outliers, the threshold can be increased. Alternatively, the number of outliers can be limited by the two arguments <code>max_n_outliers</code> and <code>max_prop_outliers</code>. E.g. if at most three outliers are to be identified, set <code>max_n_outliers = 3</code>. If at most 1% of the values are to be declared as outliers, set <code>max_prop_outliers = 0.01</code>.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1"></a><span class="kw">outliers</span>(<span class="kw">outForest</span>(irisWithOutliers, <span class="dt">max_n_outliers =</span> <span class="dv">3</span>, <span class="dt">verbose =</span> <span class="dv">0</span>))</span>
<span id="cb13-2"><a href="#cb13-2"></a><span class="co">#&gt;   row          col   observed predicted      rmse     score threshold</span></span>
<span id="cb13-3"><a href="#cb13-3"></a><span class="co">#&gt; 3  77  Petal.Width   8.617485  1.581034 0.6437836 10.929839  7.594244</span></span>
<span id="cb13-4"><a href="#cb13-4"></a><span class="co">#&gt; 2   2 Petal.Length -13.324488  1.468350 1.5667295 -9.441858  7.594244</span></span>
<span id="cb13-5"><a href="#cb13-5"></a><span class="co">#&gt; 1 135  Sepal.Width  -5.061389  3.239251 0.9738046 -8.523928  7.594244</span></span>
<span id="cb13-6"><a href="#cb13-6"></a><span class="co">#&gt;   replacement</span></span>
<span id="cb13-7"><a href="#cb13-7"></a><span class="co">#&gt; 3         1.2</span></span>
<span id="cb13-8"><a href="#cb13-8"></a><span class="co">#&gt; 2         1.9</span></span>
<span id="cb13-9"><a href="#cb13-9"></a><span class="co">#&gt; 1         3.6</span></span></code></pre></div>
</div>
<div id="i-dont-want-outliers-to-be-replaced" class="section level2">
<h2>I don’t want outliers to be replaced!</h2>
<p>By default <code>outForest</code> replaces outliers by predictive mean matching on the out-of-bag predictions. Alternatively, you can set the <code>replace</code> argument to a different value:</p>
<ul>
<li><p>“no”: Outliers are not replaced.</p></li>
<li><p>“predicted”: Outliers are replaced by the out-of-bag predictions (without predictive mean matching).</p></li>
<li><p>“NA”: Outliers are replaced by missing values.</p></li>
</ul>
<p>So if you would like to replace outliers by NAs, write:</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1"></a>out &lt;-<span class="st"> </span><span class="kw">outForest</span>(irisWithOutliers, <span class="dt">replace =</span> <span class="st">&quot;NA&quot;</span>, <span class="dt">verbose =</span> <span class="dv">0</span>)</span>
<span id="cb14-2"><a href="#cb14-2"></a><span class="kw">head</span>(<span class="kw">Data</span>(out))</span>
<span id="cb14-3"><a href="#cb14-3"></a><span class="co">#&gt;   Sepal.Length Sepal.Width Petal.Length Petal.Width Species</span></span>
<span id="cb14-4"><a href="#cb14-4"></a><span class="co">#&gt; 1          5.1         3.5          1.4         0.2  setosa</span></span>
<span id="cb14-5"><a href="#cb14-5"></a><span class="co">#&gt; 2          4.9         3.0           NA         0.2  setosa</span></span>
<span id="cb14-6"><a href="#cb14-6"></a><span class="co">#&gt; 3          4.7         3.2          1.3         0.2  setosa</span></span>
<span id="cb14-7"><a href="#cb14-7"></a><span class="co">#&gt; 4          4.6         3.1          1.5         0.2  setosa</span></span>
<span id="cb14-8"><a href="#cb14-8"></a><span class="co">#&gt; 5          5.0         3.6          1.4         0.2  setosa</span></span>
<span id="cb14-9"><a href="#cb14-9"></a><span class="co">#&gt; 6          5.4         3.9          1.7         0.4  setosa</span></span></code></pre></div>
</div>
<div id="the-algorithm-takes-too-much-time.-what-can-i-do" class="section level2">
<h2>The algorithm takes too much time. What can I do?</h2>
<p><code>outForest</code> is based on fitting one random forest for each numeric variable. Since the underlying random forest implementation <code>ranger</code> uses 500 trees per default, a huge number of trees might be calculated. For larger data sets, the overall process can take very long.</p>
<p>Here are tweaks to make things faster:</p>
<ul>
<li><p>Use less trees, e.g. by setting <code>num.trees = 50</code>. Don’t use a too low value because this can lead to missing out-of-bag predictions.</p></li>
<li><p>Use smaller number of variables to be considered in a split, e.g. <code>mtry = 2</code>.</p></li>
<li><p>Use smaller bootstrap samples by setting e.g. <code>sample.fraction = 0.1</code>.</p></li>
<li><p>Use a low tree depth <code>max.depth = 6</code>.</p></li>
<li><p>Use large leafs, e.g. <code>min.node.size = 10000</code>.</p></li>
</ul>
</div>
<div id="references" class="section level2 unnumbered">
<h2>References</h2>
<div id="refs" class="references">
<div id="ref-buuren2011">
<p>Buuren, Stef van, and Karin Groothuis-Oudshoorn. 2011. “Mice: Multivariate Imputation by Chained Equations in R.” <em>Journal of Statistical Software, Articles</em> 45 (3): 1–67. <a href="https://doi.org/10.18637/jss.v045.i03">https://doi.org/10.18637/jss.v045.i03</a>.</p>
</div>
<div id="ref-Chandola2009">
<p>Chandola, Varun, Arindam Banerjee, and Vipin Kumar. 2009. “Anomaly Detection: A Survey.” <em>ACM Comput. Surv.</em> 41 (3): 15:1–15:58. <a href="https://doi.org/10.1145/1541880.1541882">https://doi.org/10.1145/1541880.1541882</a>.</p>
</div>
<div id="ref-wright2017">
<p>Wright, Marvin, and Andreas Ziegler. 2017. “Ranger: A Fast Implementation of Random Forests for High Dimensional Data in C++ and R.” <em>Journal of Statistical Software, Articles</em> 77 (1): 1–17. <a href="https://doi.org/10.18637/jss.v077.i01">https://doi.org/10.18637/jss.v077.i01</a>.</p>
</div>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
